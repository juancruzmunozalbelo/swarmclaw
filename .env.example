# Choose ONE auth method:
# 1) Claude subscription token (recommended): set CLAUDE_CODE_OAUTH_TOKEN
# 2) Anthropic-compatible provider (e.g. MiniMax): set ANTHROPIC_* vars
#
# Never commit your real secrets.

# Claude subscription (Pro/Max) token:
CLAUDE_CODE_OAUTH_TOKEN=

# Anthropic-compatible API key (some SDKs/CLIs use this name):
ANTHROPIC_API_KEY=

# Anthropic-compatible auth token (MiniMax Claude Code docs use this name):
ANTHROPIC_AUTH_TOKEN=

# Anthropic-compatible base URL (MiniMax international):
ANTHROPIC_BASE_URL=https://api.minimax.io/anthropic
MINIMAX_API_KEY=
MINIMAX_API_HOST=https://api.minimax.io
MINIMAX_CODING_PLAN_MCP_ENABLED=1

# MiniMax recommended timeouts / traffic reduction:
API_TIMEOUT_MS=3000000
CLAUDE_CODE_DISABLE_NONESSENTIAL_TRAFFIC=1

# Model selection (MiniMax docs example):
ANTHROPIC_MODEL=MiniMax-M2.5
ANTHROPIC_SMALL_FAST_MODEL=MiniMax-M2.5
ANTHROPIC_DEFAULT_SONNET_MODEL=MiniMax-M2.5
ANTHROPIC_DEFAULT_OPUS_MODEL=MiniMax-M2.5
ANTHROPIC_DEFAULT_HAIKU_MODEL=MiniMax-M2.5
# Optional fallback chain (comma-separated). Used when model errors are retryable.
ANTHROPIC_MODEL_FALLBACKS=
MODEL_CIRCUIT_BREAKER_ENABLED=1
MODEL_CIRCUIT_BREAKER_FAILURE_THRESHOLD=3
MODEL_CIRCUIT_BREAKER_OPEN_MS=600000

# Trigger word (WhatsApp). Default is Andy (matches README).
ASSISTANT_NAME=Andy

# Runtime autonomy mode
# APP_MODE=prod enables strict autonomous execution defaults.
# AUTO_CONTINUE can override explicitly (1/0).
APP_MODE=prod
AUTO_CONTINUE=1
# soft|strict|autonomous
SWARM_EXEC_MODE=strict
# Optional hard gate for deployed public URL suffix (defaults to CLOUDFLARE_ZONE_NAME when present)
# DEPLOY_REQUIRED_PUBLIC_SUFFIX=juancruzalbelo.com.ar
# Optional backlog freeze (keep only one active task for a prefix)
# BACKLOG_FREEZE_PREFIX=ECOM
# BACKLOG_FREEZE_ACTIVE_TASK=ECOM-096
MAIN_CONTEXT_MESSAGES=20
SUBAGENT_CONTEXT_MESSAGES=4
TASK_MICRO_BATCH_MAX=2
SESSION_ROTATE_MAX_CYCLES=6
SESSION_ROTATE_MAX_AGE_MS=1800000

# Subagent lane retry policy (per role/task lane)
PARALLEL_SUBAGENT_RETRY_MAX=2
PARALLEL_SUBAGENT_RETRY_BASE_MS=3000
PARALLEL_SUBAGENT_RETRY_BACKOFF_MULTIPLIER=2
PARALLEL_SUBAGENT_RETRY_MAX_DELAY_MS=20000

# Per-role inactivity timeout (ms). If role is silent for this window, attempt fails + retry.
PARALLEL_ROLE_TIMEOUT_DEFAULT_MS=90000
PARALLEL_ROLE_TIMEOUT_PM_MS=90000
PARALLEL_ROLE_TIMEOUT_SPEC_MS=120000
PARALLEL_ROLE_TIMEOUT_ARQ_MS=120000
PARALLEL_ROLE_TIMEOUT_UX_MS=90000
PARALLEL_ROLE_TIMEOUT_DEV_MS=180000
PARALLEL_ROLE_TIMEOUT_DEV2_MS=180000
PARALLEL_ROLE_TIMEOUT_QA_MS=120000

# Dashboard retry alert window (milliseconds)
SWARMDASH_RETRY_ALERT_WINDOW_MS=900000
SWARMDASH_ALERT_MIN_REQUESTS=12
SWARMDASH_ALERT_AGENT_ERROR_RATE_WARN=0.35
SWARMDASH_ALERT_AGENT_ERROR_RATE_CRIT=0.6

# Stuck monitor (heartbeat + auto-nudge + todo reconcile)
STUCK_MONITOR_ACTION_GRACE_MS=480000
STUCK_MONITOR_NUDGE_COOLDOWN_MS=300000
STUCK_MONITOR_HEARTBEAT_IDLE_AFTER_MS=120000
STUCK_MONITOR_HEARTBEAT_COOLDOWN_MS=60000
STUCK_MONITOR_ACTION_RECONCILE_MAX_LINES=600
STUCK_MONITOR_ACTION_RECONCILE_WINDOW_MS=7200000
STUCK_MONITOR_TASKS_RECONCILE_COOLDOWN_MS=20000

# Watchdog (auto-recovery)
WATCHDOG_ENABLED=1
WATCHDOG_STUCK_GRACE_MS=600000
WATCHDOG_INFLIGHT_CONTAINER_AGE_MS=1200000
WATCHDOG_STUCK_HARD_ENABLED=1
WATCHDOG_STUCK_HARD_WINDOW_MS=900000
WATCHDOG_STUCK_HARD_MIN_HEARTBEATS=4
WATCHDOG_STUCK_HARD_MAX_AGE_SPREAD_MS=60000
WATCHDOG_STUCK_HARD_COOLDOWN_MS=900000
WATCHDOG_RESTART_COOLDOWN_MS=240000
WATCHDOG_RESTART_WINDOW_MS=3600000
WATCHDOG_RESTART_MAX_PER_WINDOW=4

# Local Postgres DSN used by agents (if running `nanoclaw-postgres` container).
DATABASE_URL=postgresql://postgres:postgres@nanoclaw-postgres:5432/ecommerce
DATABASE_URL_MAIN=postgresql://postgres:postgres@nanoclaw-postgres:5432/ecommerce
PGHOST=nanoclaw-postgres
PGPORT=5432
PGUSER=postgres
PGPASSWORD=postgres
PGDATABASE=ecommerce
